# ChatBot
## XSS
Межсайтовый скриптинг (также известный как XSS) — это уязвимость веб-безопасности, которая позволяет злоумышленнику скомпрометировать взаимодействие пользователей с уязвимым приложением. Она позволяет злоумышленнику обойти политику одного и того же источника, которая предназначена для разделения различных веб-сайтов друг от друга. Уязвимости межсайтового скриптинга обычно позволяют злоумышленнику маскироваться под пользователя-жертву, выполнять любые действия, которые может выполнять пользователь, и получать доступ к любым данным пользователя. Если пользователь-жертва имеет привилегированный доступ в приложении, то злоумышленник может получить полный контроль над всеми функциями и данными приложения.

### Существует несколько типов XSS атак:
* **Отраженный XSS**. Он возникает, когда приложение получает данные в HTTP-запросе и включает эти данные в немедленный ответ небезопасным способом.
* **Хранимый XSS**. Он возникает, когда приложение получает данные из ненадежного источника и включает эти данные в свои последующие HTTP-ответы небезопасным способом.
* **DOM XSS**. Он возникает, когда приложение содержит некоторый клиентский JavaScript, который обрабатывает данные из ненадежного источника небезопасным способом, обычно путем записи данных обратно в DOM.

## Способы защиты от XSS
* Кодирование данных на выходе. Кодирование должно применяться непосредственно перед записью контролируемых пользователем данных на страницу, поскольку контекст, в который вы пишете, определяет, какой тип кодирования вам нужно использовать. Например, значения внутри строки JavaScript требуют другого типа экранирования, чем в контексте HTML. Как пример существует следующие преобразование: < преобразуется в &lt; > преобразуется в &gt;

* Проверка данных на входе. Проверка ввода пользователем корректных данных. Как пример, если на входе ожидается только числовое значение, то получение нечисловых вводных данных должны отбрасываться

## Запуск
Чтобы запустить приложение надо из корня репозитория активировать команду `docker compose up -d`

## Описание приложения
В данном приложении входной точкой является страница регистрации и входа. Внутри аккаунта нас встречает окно с информацией о себе и большое окно с чатом, где мы можем писать боту. Если попробуем отправить сообщение с тегами script, как например <script>alert(1)</script>, то получим, что при перезагрузке страницы у нас отрабатывает данный скрипт и выводит сверху окно со значением 1. Отсюда делаем вывод, что защиты от XSS здесь нет и можно попробовать реализовать данную атаку.
Также для очистки чата можно отправить сообщение `/clear`. На данный момент для того, чтобы чат не нагружать при атаках, которые могут вызвать бесконечную отправку сообщений в чат, есть ограничения на количество сообщений в чате. Максимум в чате: 7 сообщений. При превышении этого значения чат будет автоматически очищаться.

## Writeup
1. Создадим аккаунт во все поле запишем qwe. Изучим внутреннюю составляющую страницы аккаунта. Видим, что есть поле Bio. Можно предположить, что в этом поле у бота спрятан флаг в аккаунте, поэтому попробуем достать именно этот участок страницы.
2. Поработав немного с js кодом, понимаем, что данную часть можно достать при помощи следующей команды: `document.getElementById(“bio”).textContent`
3. Теперь надо посмотреть, как отправляются запросы с сообщением. Видим, что заполняется форма со следующими полями: id=”message”, которое является полем для самого сообщения и id="user", которое позволяет боту определять в какой чат надо отправлять сообщение. Данное поле используется ботом
4. Тогда попробуем реализовать форму отправки методом GET. 
```
<script>
window.onload = function() { 
var a = document.getElementById("message"); 
a.value = document.getElementById("bio").textContent; 
var b = document.getElementById("user"); 
b.value = "qwe"; 
document.forms[1].submit(); 
};
</script>
```
5. Это заставит бота отправить форму на сервер с значением поля bio. И когда перезагружаем страницу, получаем флаг `practice{lIvE_as_if_yoU_wErE_7o_D1e_T0moRrOw_h@CK_4s_if_You_wER3_7O_Live_foRever}`